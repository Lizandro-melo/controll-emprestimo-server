// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
  output   = "../node_modules/@prisma/logic"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL_LOGIC")
}

// // SISTEMA

enum redes {
  WHATSAPP
  TELEGRAM
  FACEBOOK
  LINKEDIN
  URL
}

enum Status_divida {
  PENDENTE
  PAGO
  VENCIDO
}

enum Tipo_pagamento {
  PIX
  BOLETO
  CRED
  DEB
  DINHEIRO
}

enum Tipo_cobranca {
  ANUAL
  MENSAL
  SEMANAL
  DIARIO
}

// Operador

model operador {
  uuid                String                 @id @unique
  nome_completo       String
  num_cpf             String                 @unique
  num_cnpj            String?
  data_nascimento     DateTime?
  correio_eletronico  String                 @unique
  celularOperadors    celular_operador[]
  enderecoOperadors   endereco_operador[]
  redeSocialOperadors rede_social_operador[]
  clientes            cliente[]

  configuracaos configuracao[]
  emprestimos   emprestimo[]
  pagamentos    pagamento[]
}

model celular_operador {
  id            Int      @id @default(autoincrement())
  num_cel       String   @unique
  status        Boolean  @default(true)
  uuid_operador String
  operador      operador @relation(fields: [uuid_operador], references: [uuid])
}

model endereco_operador {
  id                 Int      @id @default(autoincrement())
  codigo_postal      String
  numero_residencial String
  status             Boolean  @default(true)
  uuid_operador      String
  operador           operador @relation(fields: [uuid_operador], references: [uuid])
}

model rede_social_operador {
  id            Int      @id @unique @default(autoincrement())
  uuid_operador String
  url           String
  operador      operador @relation(fields: [uuid_operador], references: [uuid])
}

// Cliente

model cliente {
  uuid               String                @id @unique
  nome_completo      String
  num_cpf            String
  num_cnpj           String?
  data_nascimento    DateTime?
  correio_eletronico String?               @unique
  observacao         String?
  uuid_operador      String
  status             Boolean               @default(true)
  delete             Boolean?               @default(false)
  celularClientes    celular_cliente[]
  enderecoClientes   endereco_cliente[]
  redeSocialClientes rede_social_cliente[]
  operador           operador              @relation(fields: [uuid_operador], references: [uuid])
  emprestimos        emprestimo[]
  pagamentos         pagamento[]
}

model celular_cliente {
  id           Int     @id @default(autoincrement())
  num_cel      String  @unique
  status       Boolean @default(true)
  uuid_cliente String
  cliente      cliente @relation(fields: [uuid_cliente], references: [uuid])
}

model endereco_cliente {
  id                 Int     @id @default(autoincrement())
  codigo_postal      String
  numero_residencial String
  status             Boolean @default(true)
  uuid_cliente       String
  cliente            cliente @relation(fields: [uuid_cliente], references: [uuid])
}

model rede_social_cliente {
  id           Int     @id @unique @default(autoincrement())
  uuid_cliente String
  url          String
  cliente      cliente @relation(fields: [uuid_cliente], references: [uuid])
}

model configuracao {
  id                Int      @id @default(autoincrement())
  alerta_dias_antes Int
  senha_entrada     Int
  uuid_operador     String   @unique
  operador          operador @relation(fields: [uuid_operador], references: [uuid])
}

model emprestimo {
  uuid             String        @id @unique @default(uuid())
  nome_emprestimo  String
  valor_emprestimo Float
  valor_receber    Float
  valor_recebido   Float?         @default(0)
  tipo             Tipo_cobranca
  data_emprestimo  DateTime      @default(now())
  data_final       DateTime
  observacao       String?
  status           Status_divida @default(PENDENTE)
  uuid_operador    String
  uuid_cliente     String
  delete           Boolean?       @default(false)
  pagamentos       pagamento[]
  cliente          cliente       @relation(fields: [uuid_cliente], references: [uuid])
  operador         operador      @relation(fields: [uuid_operador], references: [uuid])
}

model pagamento {
  uuid            String          @id @unique @default(uuid())
  valor_pago      Float?
  valor_previsto  Float
  uuid_emprestimo String
  tipo_pagamento  Tipo_pagamento?
  data_pagamento  DateTime?
  data_vencimento DateTime
  comprovante     String?
  observacao      String?
  uuid_cliente    String
  uuid_operador   String
  delete          Boolean?         @default(false)

  cliente    cliente       @relation(fields: [uuid_cliente], references: [uuid])
  operador   operador      @relation(fields: [uuid_operador], references: [uuid])
  status     Status_divida @default(PENDENTE)
  emprestimo emprestimo    @relation(fields: [uuid_emprestimo], references: [uuid])
}
